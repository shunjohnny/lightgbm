<!DOCTYPE html>

<html>
<head>
<title>ç·šå½¢å›å¸°ãƒã‚¸æ¥½ã—ã„è§£èª¬âœ¨</title>
<link href="../styles/styles.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<style>
    <style>
    body {
        font-family: system-ui, -apple-system, sans-serif;
        max-width: 900px;
        margin: 0 auto;
        background: #f8fafc;
        padding: 2rem;
    }
    .container {
        background: white;
        border-radius: 1rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        position: relative;
    }
    .sidebar-toggle {
        position: absolute;
        top: 1rem;
        right: 1rem;
        width: 2.5rem;
        height: 2.5rem;
        border-radius: 0.5rem;
        background: white;
        border: 1px solid #e2e8f0;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.25rem;
        z-index: 1001;
        transition: all 0.2s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .sidebar-toggle:hover {
        background: #f1f5f9;
        transform: translateY(-1px);
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
    }
    .sidebar-toggle.active {
        background: #f1f5f9;
        transform: translateX(-250px);
    }
    .sidebar {
        position: absolute;
        top: 0;
        right: 0;
        width: 250px;
        height: 100%;
        background: #f1f5f9;
        border-left: 1px solid #e2e8f0;
        padding: 1rem;
        padding-top: 4rem;
        box-sizing: border-box;
        transform: translateX(100%);
        transition: transform 0.3s ease;
        z-index: 1000;
        box-shadow: -2px 0 4px rgba(0, 0, 0, 0.1);
    }
    .sidebar.open {
        transform: translateX(0);
    }
    .sidebar-content {
        height: 100%;
        overflow-y: auto;
    }
    .sidebar-item {
        display: block;
        padding: 0.75rem 1rem;
        color: #475569;
        text-decoration: none;
        transition: all 0.2s ease;
        border-radius: 0.375rem;
        margin-bottom: 0.25rem;
        font-size: 0.95rem;
    }
    .sidebar-item:hover {
        background: white;
        color: #1d4ed8;
        transform: translateX(4px);
    }
    .back-button {
        position: absolute;
        top: 1rem;
        left: 1rem;
        height: 2.5rem;
        padding: 0 1rem;
        border-radius: 0.5rem;
        background: white;
        border: 1px solid #e2e8f0;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.95rem;
        z-index: 1001;
        transition: all 0.2s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        color: #475569;
        text-decoration: none;
    }
    .back-button:hover {
        background: #f1f5f9;
        transform: translateY(-1px);
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        color: #1d4ed8;
    }
    .back-button span {
        margin-right: 0.5rem;
    }
    </style>
</head>
<body>
<div class="container">
<div class="header">
<h1>2.2 ç·šå½¢å›å¸°ã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ã¡ã‚ƒãŠï¼ğŸŒˆ</h1>
<p>äºˆæ¸¬ã®åŸºæœ¬ã ã‚ˆï¼ä¸€ç·’ã«æ¥½ã—ãå­¦ã‚“ã§ã„ã“ã†ï¼</p>
</div>
<div class="content">
<div class="card">
<h2>âœ¨ åŸºç¤çŸ¥è­˜ã®ãŠã•ã‚‰ã„</h2>
<div class="feature">
<p>ç·šå½¢å›å¸°ã¯è¶…ä¾¿åˆ©ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãªã®ï¼ç‰¹å¾´é‡ã‹ã‚‰äºˆæ¸¬å€¤ã‚’è¨ˆç®—ã§ãã¡ã‚ƒã†ã‚“ã ã‚ˆï¼ã¾ãšã¯å˜å›å¸°ã‹ã‚‰è¦‹ã¦ã„ã“ã†ï¼âœ¨</p>
<div class="formula">
<div class="formula-main">
            \[\hat{y} = w_0 + w_1x\]
          </div>
<div class="formula-variables">
<span class="formula-variable">x</span>: ç‰¹å¾´é‡ï¼ˆå…¥åŠ›å€¤ï¼‰ã ã‚ˆï¼<br/>
<span class="formula-variable">wâ‚€</span>: åˆ‡ç‰‡ï¼ã‚°ãƒ©ãƒ•ã®å§‹ç‚¹ã«ãªã‚‹ã‚ˆï¼<br/>
<span class="formula-variable">wâ‚</span>: å‚¾ãï¼ã©ã®ãã‚‰ã„å¤‰åŒ–ã™ã‚‹ã‹ã‚’è¡¨ã™ã‚ˆï¼
          </div>
</div>
</div>
</div>
<div class="card">
<h2>ğŸŒŸ å­¦ç¿’ã®æµã‚Œã‚’ãƒã‚§ãƒƒã‚¯ï¼</h2>
<div class="feature">
<p>å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã¯ \(n\) å€‹ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹ã®ï¼ãã‚Œãã‚Œã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ \(i\) (1â‰¤iâ‰¤n) ã§ç®¡ç†ã™ã‚‹ã‚ˆï¼</p>
<div class="formula">
<div class="formula-main">
            \[l(y_i, \hat{y_i}) = \frac{1}{2}(y_i - \hat{y_i})^2\]
          </div>
<div class="formula-explanation">
            ã“ã‚Œã¯äºŒä¹—èª¤å·®ï¼äºˆæ¸¬å€¤ã¨å®Ÿéš›ã®å€¤ã®å·®ã‚’äºŒä¹—ã—ãŸã‚‚ã®ã ã‚ˆï¼å°ã•ã‘ã‚Œã°å°ã•ã„ã»ã©ã„ã„æ„Ÿã˜â™ª
          </div>
</div>
</div>
<div class="tip">
<h4>ğŸ˜Š ãƒ¯ãƒ³ãƒã‚¤ãƒ³ãƒˆã‚¢ãƒ‰ãƒã‚¤ã‚¹</h4>
<p>äºŒä¹—èª¤å·®ã¯æ®‹å·®å¹³æ–¹å’Œï¼ˆRSS: Residual Sum of Squaresï¼‰ã¨ã‚‚å‘¼ã°ã‚Œã‚‹ã‚“ã ã‚ˆï¼è¦šãˆã¦ãŠãã¨ä¾¿åˆ©ï¼</p>
</div>
</div>
<div class="card">
<h2>ğŸ’» å®Ÿéš›ã«ã‚„ã£ã¦ã¿ã‚ˆã†ï¼</h2>
<div class="feature">
<h3>å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æº–å‚™ï¼</h3>
<div class="code code-python">
<span class="comment"># ã¾ãšã¯ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆï¼</span>
<span class="keyword">import</span> <span class="builtin">pandas</span> <span class="keyword">as</span> <span class="variable">pd</span>
<span class="keyword">import</span> <span class="builtin">numpy</span> <span class="keyword">as</span> <span class="variable">np</span>
<span class="keyword">import</span> <span class="builtin">matplotlib.pyplot</span> <span class="keyword">as</span> <span class="variable">plt</span>
<span class="keyword">from</span> <span class="builtin">sklearn.linear_model</span> <span class="keyword">import</span> <span class="variable">LinearRegression</span>
<span class="keyword">from</span> <span class="builtin">sklearn.metrics</span> <span class="keyword">import</span> <span class="variable">mean_squared_error</span>
</div>
</div>
<div class="success">
<h4>ğŸ‰ ã§ãã‚‹ã“ã¨ãƒªã‚¹ãƒˆ</h4>
<ul>
<li>ãƒ‡ãƒ¼ã‚¿ã®å¯è¦–åŒ–ãŒãƒãƒƒãƒãƒªï¼</li>
<li>äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ãŒç°¡å˜ã«ä½œã‚Œã‚‹ï¼</li>
<li>ç²¾åº¦ã®è©•ä¾¡ã‚‚ã‚«ãƒ³ã‚¿ãƒ³ï¼</li>
</ul>
</div>
</div>
</div>

<a class="back-button" href="../index.html">
<span>â†</span> ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
    </a>

<button class="sidebar-toggle" id="sidebarToggle">
<span>ğŸ“‘</span>
</button>
<div class="sidebar" id="sidebar">
<nav class="sidebar-content">
<a class="sidebar-item" href="1-1.html">1.1 äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«å…¥é–€ï¼âœ¨</a>
<a class="sidebar-item" href="1-2.html">1.2 æ©Ÿæ¢°å­¦ç¿’ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ã‚ˆã†ï¼ğŸ®</a>
<a class="sidebar-item" href="1-3.html">1.3 ç’°å¢ƒæ§‹ç¯‰ã‚„ã£ã¦ã¿ã‚ˆï½ï¼ğŸŒˆ</a>
<a class="sidebar-item" href="2-1.html">2-1 ãƒ‡ãƒ¼ã‚¿åˆ†æã®ãƒ‡ã‚£ãƒ¼ãƒ—ãªä¸–ç•Œã¸ã‚ˆã†ã“ãï¼ğŸŒŸ</a>
<a class="sidebar-item" href="2-2.html">2.2 ç·šå½¢å›å¸°ã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ã¡ã‚ƒãŠï¼ğŸŒˆ</a>
<a class="sidebar-item" href="2-3.html">2.3 å›å¸°æœ¨ã§äºˆæ¸¬åŠ›ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆï¼ğŸŒŸ</a>
<a class="sidebar-item" href="2-4.html">2.4 LightGBMã§äºˆæ¸¬åŠ›ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆï¼ğŸš€</a>
<a class="sidebar-item" href="3-1.html">3.1 ãƒ‡ãƒ¼ã‚¿ç†è§£ãƒã‚¸æ¥µã‚ã¡ã‚ƒãŠï¼ğŸ‘©â€ğŸ’»âœ¨</a>
<a class="sidebar-item" href="3-2.html">3.2 ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã§ãƒã‚¸äºˆæ¸¬ï¼ğŸ‘©â€ğŸ’»âœ¨</a>
<a class="sidebar-item" href="3-3.html">3.3 LightGBMåˆ†é¡ã§ãƒã‚¸äºˆæ¸¬ï¼âœ¨</a>
<a class="sidebar-item" href="3-4.html">3.4 æ¤œè¨¼ãƒ‡ãƒ¼ã‚¿è©•ä¾¡ã§ãƒ¢ãƒ‡ãƒ«è¶…ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ï¼âœ¨</a>
</nav>
</div>
<script>
        document.getElementById("sidebarToggle").addEventListener("click", function() {
            const sidebar = document.getElementById("sidebar");
            sidebar.classList.toggle("open");
            this.classList.toggle("active");
        });
    </script>
</div>
<div class="container">
<div class="card">
<h2>ğŸ¯ é‡å›å¸°ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’æ”»ç•¥ï¼</h2>
<div class="feature">
<p>å˜å›å¸°ã‚ˆã‚Šæ›´ã«ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ï¼è¤‡æ•°ã®ç‰¹å¾´é‡ã‚’ä½¿ã£ã¦äºˆæ¸¬å€¤ã‚’å‡ºã›ã¡ã‚ƒã†ã®ï¼ğŸš€</p>
<div class="formula">
<div class="formula-main">
            \[\hat{y} = w_0 + \sum_{j=1}^m w_jx_j\]
          </div>
<div class="formula-variables">
<span class="formula-variable">m</span>: ç‰¹å¾´é‡ã®æ•°ã ã‚ˆï¼<br/>
<span class="formula-variable">w_j</span>: ãã‚Œãã‚Œã®ç‰¹å¾´é‡ã®é‡ã¿ï¼<br/>
<span class="formula-variable">x_j</span>: jç•ªç›®ã®ç‰¹å¾´é‡ã®å€¤ï¼
          </div>
</div>
</div>
<div class="feature">
<h3>ğŸ”¥ è¡Œåˆ—ã§è¡¨ç¾ã™ã‚‹ã¨ã“ã‚“ãªæ„Ÿã˜ï¼</h3>
<div class="formula">
<div class="formula-main">
            \[\hat{y} = w_0 + \mathbf{w}^T\mathbf{x}\]
          </div>
<div class="formula-explanation">
            ã“ã“ã§ \(\mathbf{w}\) ã¨ \(\mathbf{x}\) ã¯ãƒ™ã‚¯ãƒˆãƒ«ãªã®ï¼ã™ã”ãä¾¿åˆ©ã ã‚ˆã­ï¼âœ¨
          </div>
</div>
</div>
</div>
<div class="card">
<h2>ğŸ“Š å®Ÿè·µç·¨ï¼šBostonãƒã‚¦ã‚¹ãƒ—ãƒ©ã‚¤ã‚¹äºˆæ¸¬ï¼</h2>
<div class="feature">
<h3>ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™ã‹ã‚‰å§‹ã‚ã‚ˆã†ï¼</h3>
<div class="code code-python">
<span class="comment"># ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€ã‚ˆï¼</span>
  df = pd.read_csv(<span class="string">'https://archive.ics.uci.edu/ml/machine-learning-databases/housing/housing.data'</span>, 
      header=None, sep=<span class="string">'\s+'</span>)
  <span class="comment"># ç‰¹å¾´é‡ã‚’è¨­å®šï¼MEDVã¯ç›®çš„å¤‰æ•°ã ã‚ˆï¼</span>
  X = df.drop(['MEDV'], axis=1)
  y = df['MEDV']
        </div>
</div>
<div class="tip">
<h4>ğŸ’¡ ãƒ‡ãƒ¼ã‚¿ã®åˆ†å‰²ãŒè¶…é‡è¦ï¼</h4>
<p>å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã¯8:2ã§åˆ†ã‘ã‚‹ã®ãŒãŠã™ã™ã‚ï¼ã“ã®æ¯”ç‡ãŒãƒ™ã‚¹ãƒˆãƒãƒ©ãƒ³ã‚¹ï¼</p>
<div class="code code-python">
  X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, 
      shuffle=True, random_state=0)
        </div>
</div>
</div>
<div class="card">
<h2>âœ¨ ç‰¹å¾´é‡ã®æ¨™æº–åŒ–ã§ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ï¼</h2>
<div class="feature">
<p>ç‰¹å¾´é‡ã®ã‚¹ã‚±ãƒ¼ãƒ«ã‚’æƒãˆã‚‹ã“ã¨ã§ã€äºˆæ¸¬ç²¾åº¦ãŒã‚°ãƒƒã¨ã‚¢ãƒƒãƒ—ï¼âœ¨</p>
<div class="formula">
<div class="formula-main">
            \[x_{std} = \frac{x - \mu}{\sigma}\]
          </div>
<div class="formula-explanation">
            å¹³å‡ã‚’0ã€æ¨™æº–åå·®ã‚’1ã«å¤‰æ›ã™ã‚‹ã‚ˆï¼ã“ã‚Œã§ç‰¹å¾´é‡ã®é‡è¦åº¦ãŒæ¯”è¼ƒã—ã‚„ã™ããªã‚‹ã®ï¼
          </div>
</div>
<div class="code code-python">
<span class="comment"># StandardScalerã§ãƒ©ã‚¯ãƒ©ã‚¯æ¨™æº–åŒ–ï¼</span>
<span class="keyword">from</span> <span class="builtin">sklearn.preprocessing</span> <span class="keyword">import</span> StandardScaler
  scaler = StandardScaler()
  X_train_scaled = scaler.fit_transform(X_train)
  X_test_scaled = scaler.transform(X_test)
        </div>
</div>
<div class="warning">
<h4>âš ï¸ æ³¨æ„ãƒã‚¤ãƒ³ãƒˆï¼</h4>
<p>ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã¯å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã§è¨ˆç®—ã—ãŸå¹³å‡ã¨æ¨™æº–åå·®ã§æ¨™æº–åŒ–ã™ã‚‹ã®ï¼ã“ã“é–“é•ãˆã‚„ã™ã„ã‹ã‚‰æ°—ã‚’ã¤ã‘ã¦ã­ï¼</p>
</div>
</div>
<div class="card">
<h2>ğŸ“ˆ äºˆæ¸¬å€¤ã®è§£é‡ˆæ–¹æ³•</h2>
<div class="feature">
<p>äºˆæ¸¬çµæœã‚’ã‚°ãƒ©ãƒ•ã§å¯è¦–åŒ–ã™ã‚‹ã¨è¶…åˆ†ã‹ã‚Šã‚„ã™ã„ï¼</p>
<div class="code code-python">
<span class="comment"># å›å¸°ä¿‚æ•°ã‚’å¯è¦–åŒ–ï¼</span>
  importances = model.coef_
  indices = np.argsort(importances)[::-1]
  plt.figure(figsize=(8, 4))
  plt.bar(range(X.shape[1]), importances[indices])
  plt.xticks(range(X.shape[1]), X.columns[indices], rotation=90)
  plt.show()
        </div>
</div>
<div class="success">
<h4>ğŸŒŸ è§£é‡ˆã®ã‚³ãƒ„ï¼</h4>
<ul>
<li>ãƒ—ãƒ©ã‚¹ã®ä¿‚æ•°ï¼šãã®ç‰¹å¾´é‡ãŒå¤§ãã„ã»ã©äºˆæ¸¬å€¤ã‚‚å¤§ãããªã‚‹ï¼</li>
<li>ãƒã‚¤ãƒŠã‚¹ã®ä¿‚æ•°ï¼šãã®ç‰¹å¾´é‡ãŒå¤§ãã„ã»ã©äºˆæ¸¬å€¤ã¯å°ã•ããªã‚‹ï¼</li>
<li>ä¿‚æ•°ã®çµ¶å¯¾å€¤ãŒå¤§ãã„ã»ã©ã€ãã®ç‰¹å¾´é‡ã®å½±éŸ¿åŠ›ãŒå¼·ã„ã£ã¦ã“ã¨ï¼</li>
</ul>
</div>
</div>
<div class="card">
<h2>ğŸ“ è©•ä¾¡æŒ‡æ¨™ã§ãƒã‚§ãƒƒã‚¯ï¼</h2>
<div class="feature">
<p>RMSEã§äºˆæ¸¬ã®ç²¾åº¦ã‚’ç¢ºèªï¼å°ã•ã‘ã‚Œã°å°ã•ã„ã»ã©Goodï¼âœ¨</p>
<div class="code code-python">
  rmse = np.sqrt(mean_squared_error(y_test, y_test_pred))
  print(<span class="string">f'RMSE test: {rmse:.2f}'</span>)
        </div>
</div>
</div>
</div>
</body>
</html>